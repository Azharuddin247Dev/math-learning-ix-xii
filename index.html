<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WB Math Learning Portal</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <h2>üìö WB Math Portal for classes IX to XII</h2>
                <span class="nav-subtitle">Classes IX-XII</span>
            </div>
            <div class="nav-links">
                <a href="index.html" class="nav-link active">üè† Home</a>
                <a href="leaderboard.html" class="nav-link">üèÜ Leaderboard</a>
                <a href="performance.html" class="nav-link">üìä Analytics</a>
                <a href="admin.html" class="nav-link" id="admin-nav-link" style="display: none;">‚öôÔ∏è Admin</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Login/Signup Screen -->
        <div id="auth-container">
            <div class="auth-header">
                <h1>West Bengal Mathematics Portal</h1>
                <p>Classes IX to XII</p>
                <div id="welcome-notice"
                    style="background: #d4edda; border: 1px solid #c3e6cb; padding: 15px; border-radius: 8px; margin: 15px 0; font-size: 14px; color: #155724;">
                    üéì <strong>Welcome to WB Math Portal!</strong> Create your account to start your mathematics
                    learning journey with interactive tests and performance tracking.
                </div>
            </div>

            <div class="auth-tabs">
                <button class="tab-btn active" onclick="showLogin()">Login</button>
                <button class="tab-btn" onclick="showSignup()">Sign Up</button>
            </div>

            <div id="login-form" class="auth-form">
                <h2>Login</h2>
                <input type="email" id="login-email" placeholder="Email ID" required>
                <input type="password" id="login-password" placeholder="Password" required>
                <button onclick="login()">Login</button>
                <p class="forgot-password"><a href="#" onclick="showFeedbackModal()">Forgot Password? Request Reset</a>
                </p>
            </div>

            <div id="signup-form" class="auth-form" style="display: none;">
                <h2>Sign Up</h2>
                <input type="email" id="signup-email" placeholder="Email ID" required>
                <input type="password" id="signup-password" placeholder="Password" required>
                <input type="password" id="confirm-password" placeholder="Confirm Password" required>
                <button onclick="signup()">Sign Up</button>
            </div>
        </div>

        <!-- Name Input Screen -->
        <div id="name-container" style="display: none;">
            <h2>Welcome! Please enter your name</h2>
            <input type="text" id="user-name" placeholder="Your Full Name" maxlength="50">
            <button onclick="saveName()">Continue</button>
        </div>

        <!-- Class Selection Screen -->
        <div id="class-container" style="display: none;">
            <div class="user-header">
                <div class="user-info">
                    <span id="user-display-name">Welcome, User!</span>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
            <h2>Select Your Class</h2>
            <div class="class-buttons">
                <button onclick="selectClass(9)">Class IX</button>
                <button onclick="selectClass(10)">Class X</button>
                <button onclick="selectClass(11)">Class XI</button>
                <button onclick="selectClass(12)">Class XII</button>
            </div>
        </div>

        <!-- Chapter Selection Screen -->
        <div id="chapter-container" style="display: none;">
            <div class="user-header">
                <div class="user-info">
                    <span id="user-display-name-2">Welcome, User!</span>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
            <h2 id="class-title">Class IX - Mathematics</h2>
            <div id="chapters-list"></div>
            <button onclick="goBackToClass()">Back to Classes</button>
        </div>

        <!-- Question Type Selection -->
        <div id="type-container" style="display: none;">
            <div class="user-header">
                <div class="user-info">
                    <span id="user-display-name-3">Welcome, User!</span>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
            <h2 id="chapter-title">Chapter: Numbers</h2>
            <div class="type-buttons">
                <button onclick="selectType('short')">Short Questions</button>
                <button onclick="selectType('broad')">Broad Questions</button>
            </div>
            <button onclick="goBackToChapters()">Back to Chapters</button>
        </div>

        <!-- Reading Section -->
        <div id="reading-container" style="display: none;">
            <div class="user-header">
                <div class="user-info">
                    <span id="user-display-name-4">Welcome, User!</span>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
            <div class="reading-header">
                <h2 id="reading-title">Reading: Chapter 1 - Numbers</h2>
                <p>Page <span id="current-page">1</span> of <span id="total-pages">4</span></p>
            </div>
            <div id="questions-content"></div>
            <div class="reading-nav">
                <button id="prev-btn" onclick="prevPage()" disabled>Previous</button>
                <button id="next-btn" onclick="nextPage()">Next</button>
                <button id="test-btn" onclick="startTest()" style="display: none;">Take Test</button>
            </div>
        </div>

        <!-- Test Section -->
        <div id="test-container" style="display: none;">
            <div class="user-header">
                <div class="user-info">
                    <span id="user-display-name-5">Welcome, User!</span>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
            <div class="test-header">
                <h2 id="test-title">Test: Chapter 1 - Numbers</h2>
                <div class="test-info">
                    <span>Question <span id="test-current">1</span> of <span id="test-total">10</span></span>
                    <span>Time: <span id="timer">20:00</span></span>
                </div>
            </div>
            <div id="test-question"></div>
            <div id="test-options"></div>
            <button id="submit-answer" onclick="submitAnswer()" disabled>Submit Answer</button>
        </div>

        <!-- Results Section -->
        <div id="result-container" style="display: none;">
            <div class="user-header">
                <div class="user-info">
                    <span id="user-display-name-6">Welcome, User!</span>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
            <h2>Test Results</h2>
            <div id="result-info"></div>
            <div id="leaderboard"></div>
            <div class="result-buttons">
                <button onclick="retakeTest()">Retake Test</button>
                <button onclick="goBackToChapters()">Back to Chapters</button>
                <button onclick="window.open('leaderboard.html', '_blank')">üèÜ Global Leaderboard</button>
                <button onclick="window.open('performance.html', '_blank')">üìä Performance Dashboard</button>
            </div>
        </div>

        <!-- Coming Soon Modal -->
        <div id="coming-soon-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <h3>Coming Soon!</h3>
                <p>Broad questions feature will be available in future updates.</p>
                <button onclick="closeModal()">OK</button>
            </div>
        </div>

        <!-- Feedback Modal -->
        <div id="feedback-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <h3>Send Feedback / Password Reset Request</h3>
                <textarea id="feedback-message"
                    placeholder="Please describe your issue or request password reset for your email..."
                    rows="5"></textarea>
                <input type="email" id="feedback-email" placeholder="Your Email (for password reset)">
                <div class="modal-buttons">
                    <button onclick="sendFeedback()">Send Request</button>
                    <button onclick="closeFeedbackModal()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-section">
                <h4>üìö WB Math Portal</h4>
                <p>Comprehensive mathematics learning platform for classes IX-XII</p>
            </div>
            <div class="footer-section">
                <h4>Quick Links</h4>
                <a href="index.html">Home</a>
                <a href="leaderboard.html">Leaderboard</a>
                <a href="performance.html">Analytics</a>
            </div>
            <div class="footer-section">
                <h4>Features</h4>
                <p>‚úì Interactive Tests</p>
                <p>‚úì Performance Tracking</p>
                <p>‚úì Real-time Analytics</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; Azharuddin247. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="js/firebase-config-simple.js"></script>
    <script src="js/admin-auth.js"></script>
    <script src="data/chapters.js"></script>
    <script src="js/chapter-data-fallback.js"></script>
    <script>
        // Debug: Check if chapters loaded
        window.addEventListener('load', () => {
            console.log('Chapter data check:', window.classChapters ? 'Loaded' : 'Not loaded');
            if (window.classChapters) {
                console.log('Available classes:', Object.keys(window.classChapters));
            }
        });
    </script>
    <script src="js/chapter-loader.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/app.js"></script>
</body>

</html>
